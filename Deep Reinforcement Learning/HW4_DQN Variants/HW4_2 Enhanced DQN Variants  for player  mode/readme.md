# HW4-2: Enhanced DQN â€“ Double DQN for Player Mode ğŸ®ğŸ§ 

æœ¬ä½œæ¥­åœ¨éš¨æ©Ÿèµ·é»ï¼ˆplayer modeï¼‰ç’°å¢ƒä¸­ï¼Œå¯¦ä½œèˆ‡æ¸¬è©¦ **Double DQN**ï¼Œç›®æ¨™æ˜¯æ”¹å–„ Naive DQN çš„ Q-value é«˜ä¼°å•é¡Œï¼Œæå‡å­¸ç¿’ç©©å®šæ€§èˆ‡æ³›åŒ–èƒ½åŠ›ã€‚

---

## ğŸ“Œ ä»»å‹™ç›®æ¨™

- âœ… å¯¦ä½œ Double DQN å¢å¼·ç‰ˆ
- âœ… æ‡‰ç”¨æ–¼ player mode ç’°å¢ƒï¼ˆèµ·é»éš¨æ©Ÿï¼‰
- âœ… åˆ†æèˆ‡ Naive DQN çš„å·®ç•°
- âœ… è©•ä¼°è¨“ç·´ç©©å®šæ€§èˆ‡æ¸¬è©¦æˆåŠŸç‡

---

## ğŸ§  Double DQN æ¶æ§‹é‡é»

- å¼•å…¥ **ç›®æ¨™ç¶²è·¯ target_net**ï¼Œèˆ‡ä¸»ç¶²è·¯ policy_net åˆ†é–‹
- ç”¨ä¸»ç¶²è·¯é¸å‹•ä½œ (`argmax`)ï¼Œç”¨ç›®æ¨™ç¶²è·¯ä¼°å€¼ï¼ˆ`gather`ï¼‰
- æ¯ N å›åˆåŒæ­¥ä¸€æ¬¡ target_netï¼Œé™ä½ Q-value é«˜ä¼°å•é¡Œ

ä»¥ä¸‹ç‚ºæ ¸å¿ƒæ›´æ–°é‚è¼¯ï¼š

```python
# Double DQN æ›´æ–°é‚è¼¯
next_actions = policy_net(next_states).argmax(1)
next_q_values = target_net(next_states).gather(1, next_actions.unsqueeze(1)).squeeze(1)
target = rewards + gamma * next_q_values * (1 - dones)
```

---

## âš™ï¸ åŸ·è¡Œæ–¹å¼

### å¥—ä»¶å®‰è£

è«‹å…ˆå®‰è£æ‰€éœ€å¥—ä»¶ï¼š

```bash
pip install torch numpy
```

ï¼ˆè‹¥ä½ ä½¿ç”¨ OpenAI Gym ç’°å¢ƒï¼Œä¹Ÿå¯é¡å¤–å®‰è£ï¼‰

```bash
pip install gym
```

---

### åŸ·è¡Œè¨“ç·´èˆ‡æ¸¬è©¦

```bash
python hw4_2_double_dqn_player.py
```

æˆåŠŸåŸ·è¡Œå¾Œï¼Œå°‡çœ‹åˆ°å¦‚ä¸‹è¼¸å‡ºï¼š

```
Episode 97/100 å®Œæˆ
Episode 98/100 å®Œæˆ
Episode 99/100 å®Œæˆ
Episode 100/100 å®Œæˆ
æ¸¬è©¦ Episode 1: ç¸½å›å ± = 1.0
æ¸¬è©¦ Episode 2: ç¸½å›å ± = 11.0
æ¸¬è©¦ Episode 3: ç¸½å›å ± = 5.0
æ¸¬è©¦ Episode 4: ç¸½å›å ± = 1.0
æ¸¬è©¦ Episode 5: ç¸½å›å ± = 1.0
```
![image](https://github.com/user-attachments/assets/cc1122d2-e5f2-4a9b-86ae-31714e56f355)

---

## ğŸ§ª å¯¦é©—çµæœï¼ˆplayer modeï¼‰

- è¨“ç·´ Episode æ•¸ï¼š100
- æ¸¬è©¦å›åˆæ•¸ï¼š5
- æ¸¬è©¦çµæœé¡¯ç¤ºï¼Œåœ¨ player mode éš¨æ©Ÿèµ·é»ä¸‹ï¼ŒDouble DQN ä»èƒ½å­¸æœƒç©©å®šç­–ç•¥ï¼Œé›–æœ‰å›å ±å·®ç•°ï¼Œä½†å¤§å¤šæˆåŠŸå®Œæˆä»»å‹™ã€‚

---

## ğŸ“‚ æª”æ¡ˆèªªæ˜

| æª”æ¡ˆåç¨±                    | èªªæ˜                                   |
|-----------------------------|----------------------------------------|
| `hw4_2_double_dqn_player.py` | Double DQN å¯¦ä½œèˆ‡è¨“ç·´æµç¨‹              |
| `requirements.txt`           | Python åŸ·è¡Œç’°å¢ƒæ‰€éœ€å¥—ä»¶ï¼ˆèˆ‡ HW4-1 ç›¸åŒï¼‰|

---

## ğŸ“ å¿ƒå¾—èˆ‡åæ€

æœ¬ä½œæ¥­è®“æˆ‘æ·±å…¥ç†è§£ Q-learning éåº¦ä¼°è¨ˆçš„å•é¡Œï¼Œä»¥åŠç‚ºä½•éœ€è¦ä½¿ç”¨ Double DQN æ¶æ§‹é€²è¡Œä¿®æ­£ã€‚  
é€é player mode çš„éš¨æ©Ÿèµ·é»è¨­è¨ˆï¼Œæ›´èƒ½æ¸¬è©¦ agent çš„æ³›åŒ–èƒ½åŠ›èˆ‡ç©©å®šæ€§ã€‚  
å¯¦ä½œéç¨‹ä¸­ä¹Ÿå­¸æœƒå¦‚ä½•åœ¨ PyTorch ä¸­åˆ‡åˆ†ä¸»ç¶²è·¯èˆ‡ç›®æ¨™ç¶²è·¯ï¼Œä¸¦ä½¿ç”¨ `.gather()` è™•ç†å‹•ä½œé¸æ“‡èˆ‡è©•ä¼°åˆ†é›¢ã€‚

